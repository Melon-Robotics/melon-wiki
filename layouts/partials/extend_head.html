{{/* Extended SEO — loaded by PaperMod after its own head partial */}}

{{/* Content-type hints for search engines */}}
<meta name="subject" content="{{ .Description | default site.Params.description }}">
<meta name="coverage" content="Worldwide">
<meta name="distribution" content="Global">
<meta name="rating" content="General">

{{/* Per-page keyword meta (supplements global keywords) */}}
{{- if .Params.keywords }}
<meta name="keywords" content="{{ delimit .Params.keywords ", " }}">
{{- end }}

{{/* DNS prefetch for external resources */}}
<link rel="dns-prefetch" href="//fonts.googleapis.com">
<link rel="dns-prefetch" href="//fonts.gstatic.com">

{{/* Homepage: WebSite schema with SearchAction (complements PaperMod's Organization schema) */}}
{{- if .IsHome }}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "WebSite",
  "name": "{{ site.Title }}",
  "url": "{{ site.BaseURL }}",
  "description": "{{ site.Params.description }}",
  "inLanguage": "en-US",
  "potentialAction": {
    "@type": "SearchAction",
    "target": "{{ site.BaseURL }}search/?q={search_term_string}",
    "query-input": "required name=search_term_string"
  }
}
</script>
{{- end }}

{{/* Section pages: CollectionPage with ItemList (complements PaperMod's BreadcrumbList) */}}
{{- if .IsSection }}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "CollectionPage",
  "name": "{{ .Title }}",
  "url": "{{ .Permalink }}",
  "description": "{{ .Description | default site.Params.description }}",
  "isPartOf": {
    "@type": "WebSite",
    "name": "{{ site.Title }}",
    "url": "{{ site.BaseURL }}"
  },
  "mainEntity": {
    "@type": "ItemList",
    "numberOfItems": {{ len .Pages }},
    "itemListElement": [
      {{- range $i, $page := .Pages }}
      {{- if $i }},{{ end }}
      {
        "@type": "ListItem",
        "position": {{ add $i 1 }},
        "url": "{{ $page.Permalink }}",
        "name": "{{ $page.Title }}"
      }
      {{- end }}
    ]
  }
}
</script>
{{- end }}

{{/* Article pages: add articleSection to complement PaperMod's BlogPosting + BreadcrumbList */}}
{{- if and .IsPage (not .IsHome) }}
{{- if .Parent }}
<meta name="article:section" content="{{ .Parent.Title }}">
{{- end }}
{{- end }}

{{/* TechArticle schema for authoritative reference pages */}}
{{- if eq .Params.schema_type "tech-article" }}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "TechArticle",
  "headline": {{ .Title | jsonify }},
  "description": {{ .Description | jsonify }},
  "url": "{{ .Permalink }}",
  "inLanguage": "en-US",
  "proficiencyLevel": "Expert",
  "author": {
    "@type": "Organization",
    "name": {{ .Params.schema_author | default "Naval Sea Systems Command (NAVSEA)" | jsonify }}
  },
  "publisher": {
    "@type": "Organization",
    "name": "Melon Wiki",
    "url": "{{ site.BaseURL }}"
  },
  {{- if .Params.schema_about }}
  "about": [
    {{- range $i, $topic := .Params.schema_about }}
    {{- if $i }},{{ end }}
    { "@type": "Thing", "name": {{ $topic | jsonify }} }
    {{- end }}
  ],
  {{- end }}
  {{- if .Params.keywords }}
  "keywords": {{ delimit .Params.keywords ", " | jsonify }},
  {{- end }}
  "datePublished": "{{ .Date.Format "2006-01-02" }}",
  "dateModified": "{{ .Lastmod.Format "2006-01-02" }}"
}
</script>
{{- end }}

{{/* Dataset schema for pages with structured table data */}}
{{- if eq .Params.schema_type "dataset" }}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Dataset",
  "name": {{ .Title | jsonify }},
  "description": {{ .Description | jsonify }},
  "url": "{{ .Permalink }}",
  "inLanguage": "en-US",
  "license": "https://creativecommons.org/licenses/by/4.0/",
  "creator": {
    "@type": "Organization",
    "name": "Naval Sea Systems Command (NAVSEA)",
    "url": "https://www.navsea.navy.mil/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Melon Wiki",
    "url": "{{ site.BaseURL }}"
  },
  "datePublished": "{{ .Date.Format "2006-01-02" }}"
}
</script>
{{- end }}

{{/* FAQPage schema — populated from front matter faq array [[faq]] {q, a} */}}
{{- if .Params.faq }}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "FAQPage",
  "mainEntity": [
    {{- range $i, $item := .Params.faq }}
    {{- if $i }},{{ end }}
    {
      "@type": "Question",
      "name": {{ $item.q | jsonify }},
      "acceptedAnswer": {
        "@type": "Answer",
        "text": {{ $item.a | jsonify }}
      }
    }
    {{- end }}
  ]
}
</script>
{{- end }}
